/*********************************************************************************
* DISTRIBUTION STATEMENT A. Approved for public release. Distribution is unlimited.
*
* This material is based upon work supported under Air Force Contract No. FA8702-15-D-0001. Any opinions, findings, conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the U.S. Air Force.
*
* (c) 2023 Massachusetts Institute of Technology.
*
* Subject to FAR52.227-11 Patent Rights - Ownership by the contractor (May 2014)
*
* The software/firmware is provided to you on an As-Is basis
*
* Delivered to the U.S. Government with Unlimited Rights, as defined in DFARS Part 252.227-7013 or 7014 (Feb 2014). Notwithstanding any copyright notice, U.S. Government rights in this work are defined by DFARS 252.227-7013 or DFARS 252.227-7014 as detailed above. Use of this work other than as specifically authorized by the U.S. Government may violate any copyrights that exist in this work.
*********************************************************************************/

# Description

Software for distributed retrodirective transmit beamforming analysis, simulations, and experiments. The `matlab` folder contains scripts for analysis, signal generation, and post-processing. The `rtbf` folder contains the program used for real-time processing demonstrations/experiments (written in Python using GNU Radio and UHD).

# Setup

Running many of the scripts/programs will first require the Gold code sequences be generated. For example, the main Python programs will look for a .mat file generated by MATLAB. This can be generated by running the script `matlab/util/make_gc.mat.m`. The MATLAB simulations also require folders be added to the path, which can be done by running the script `matlab/setup_env.m`.

## Simulations

The `matlab/sims` folder contains scripts for simulating the system and a few of its components. The primary simulation is in `sim_retro_tx_bf.m`, which steps through the protocol steps and signal processing. There are two additional scripts for characterizing the performance of the system with errors, and one other script for simulating the frequency offset estimator required in the receive signal processing chain.

There are various objects used in simulation (transmitter, channel model, etc.) in the `matlab/objects` folder, and tests for those objects and other functions in the `matlab/tests` folder.

## Experiments

The `rtbf` folder contains code used for the real-time demonstrations (on the bench-top and with UAVs). The main program is `test_node.sh`, which is a shell wrapper for `test_node.py` that performs additional logging to enable post-processing and analysis of the results. Post-processing scripts for the log files are in the `matlab/proc` directory. That directory also includes a script for checking the RX data at one of the nodes (the debug sinks must be enabled in `test_node.py` to facilitate this).

Note that users must be mindful of the settings in `test_node.py`, such as the transmit/receive gains of the USRPs, so that hardware is not damaged. These gains should be set based on the test environment.

There are a few helper scripts developed during the course of implementing the processing in real-time. Two scripts are used to benchmark FFT and cross-correlation performance using different techniques; these can be used to then manually select which functions to call during processing in `test_node.py`. There is also a script to set the CPU governor and power mode to performance, so that the full capabilities of the host computer can be used. Note that these were only tested on the Fedora 35 OS and may require different commands for other OS.

## Software Versions

MATLAB R2021a
Python 3.9.9 with numpy, scipy, and pyFFTW modules
GNU Radio 3.8.4.0
UHD 3.15.0.0-MacPorts-Release